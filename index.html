<html>
  <head>
    <style>
      body {
        margin:5%;
        font-family:sans-serif;
      }
      #t {
        width:500px;
        height:300px;
      }
      .container{
        background-color:#eee;
      }
      .tabs {
        margin:0;
        padding:0;
      }
      .tabs li{
        float:left;
        list-style:none;
        margin:4px;
        background-color:silver;
      }
      .tabs a{
        display:block;
        padding:4px 16px 14px 16px;
        text-decoration:none;
        font-size:16px;
        color:black;
        -webkit-border-radius: 10px;
        border: 1px solid #000;
      }
      .builder {
        background-color:white;
        overflow:auto;
      }
      div, blockquote{
        margin:0;
        padding:0;
      }
      div {
        background-color:#cfc;
        margin:1px;
        padding:2px;
        xpadding-left:0;
      }
      blockquote{
        padding-left:15px;
      }
      .val{
        font-style:italic;
      }
      .key a, .val a{
        color:black;
        text-decoration:none;
      }
      .icon{
        display:block;
        float:right;
        text-decoration:none;
        padding-left:5px;
        color:blue;
      }
    </style>
    <script src="jquery-1.2.6.js"></script>
    <script>
    
      function edit(e){
        if(!e.editing){
          e.editing = true;
          var input = document.createElement("INPUT");
          input.value = e.innerText;
          input.onblur = function(){
            var val = input.value;
            e.innerHTML = "";
            e.innerText = val;
            e.editing = false;
          }
          e.innerText = "";
          $(e).append(input);
          input.focus();
        }
      }
      
      function inspect(e){
        var builder = $(".builder", e).clone();
        $(".icon", builder).remove();
        $(".editable", builder).each(function(i){
          $(this).prepend('"');
          $(this).append('"');
        });
        var txt = builder.text();
        
        alert(txt);
      }
      
      function insert(button){
        $(button.parentNode.nextSibling).append('<div>'+DELETE+BRACE+BRACKET+'<b class="key">'+
          editable("key")+'</b>:<span class="val">'+
          editable("value")+'</span> </div>'
        );
      }
      
      function editable(text){
        return '<a class="editable" href="#" onclick="edit(this);return false">'+text+'</a>';
      }
    
      function JSONEditor(wrapped) {
        
        
        function build(json, node){
          node = $(node);
          if(json instanceof Array){
            var bq = $(document.createElement("BLOCKQUOTE"));
            node.append(bq);
            build(json[0], bq);
            node.append("<div>]</div>");
          } else if (json instanceof Object){          
              node.append('<div>'+DELETE+ADD+'{</div>');
            var bq = $(document.createElement("BLOCKQUOTE"));
            node.append(bq);
            for(var i in json){
              var div = document.createElement("DIV");
              div.innerHTML = DELETE+BRACE+BRACKET+'<b class="key">'+editable(i)+'</b>: ';
              if(json[i] instanceof Array) {
                div.innerHTML += "[";
              } else if (json[i] instanceof Object){          
                //nothing
              } else{
                $(div).append('<span class="val">'+editable(json[i].toString())+'</span>')
              }
               
              bq.append(div);
              build(json[i],bq);
            }
            node.append('<div>}</div>');
          } else{  
            // ignore, already handled
          }
        }
        
        var BRACE = '<a class="icon" href="#"><strong>{</strong></a>';
        var BRACKET = '<a class="icon" href="#"><strong>[</a>';
        var DELETE = '<a class="icon" href="#"><img src="delete.png" /></a>';
        var ADD = '<a class="icon" href="#" onclick="insert(this);return false"><img src="add.png" /></a>';
        
        var TAB_SIZE = 30;
        var guid = "something"; // FIXME
        var wrapped = wrapped;
        var builderTab = '<li><a href="javascript:$(\'.builder\', $(\'#'+guid+'\')).show()">builder</a></li>';
        var textTab = '<li><a href="javascript:$(\'.builder\', $(\'#'+guid+'\')).hide()">text</a></li>';
        var debugTab = '<li><a href="javascript:inspect($(\'#'+guid+'\'))">debug</a></li>';
        
        wrapped.wrap('<div id="'+guid+'" class="container"></div>');
        container = $("#"+guid);
        container.prepend('<ul class="tabs"></ul>');
        var tabs = $(".tabs", container);
        tabs.append(builderTab);
        tabs.append(textTab);
        tabs.append(debugTab);
        
        container.width(wrapped.width()).height(wrapped.height() + TAB_SIZE);
        container.css("position", "relative");
        container.append('<div class="builder"></div>');
        var builder = $(".builder", container);
        builder.css("position", "absolute").css("top", TAB_SIZE + "px").css("left", 0);
        builder.width(wrapped.width()).height(wrapped.height());
        
        wrapped.css("position", "absolute").css("top", TAB_SIZE + "px").css("left", 0);
        build(eval("("+wrapped.val()+")"), builder);
        return this;  
      }
    
      $(document).ready(function(){
        var j = JSONEditor($("#t"));
      });
    </script>
  </head>
  <body>
<textarea id="t">{
  "name": "a.title",
  "description": "foo.bar",
  "authors": [{
    "name": "p.foo",
    "link": "a | @href"
  }]
}
    </textarea>
  </body>  
</html>